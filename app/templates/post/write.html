{% extends "base.html" %}
{% block title %}Write{% endblock %}
{% block extra_head %}
{{super()}}
<!-- Include all compiled plugins (below), or include individual files as needed -->
<link rel="stylesheet" href="{{url_for('static', filename='css/admin.css')}}" type="text/css" />
<link rel="stylesheet" href="{{url_for('static', filename='editor/editor.css')}}" type="text/css" />
<link rel="stylesheet" href="{{url_for('static', filename='css/write.css')}}" type="text/css" />
<!-- Bootstrap JS -->
<script type="text/javascript" src="{{url_for('static', filename='markdown/js/marked.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='editor/editor.js')}}"></script>
{% endblock %}

{% block main %}

<div class="well">
<h5>Result</h5>
	<div class="editor-wrapper">
		<form action="#" method="post" accept-charset="utf-8" name="workspace">
			<input name="title" class="title" type="text" placeholder="Title" id="title"/>
			<input name="title_pic" class="title" type="text" placeholder="Title Picture Url" id="title_pic"/>
			<input type="hidden" name="published" id="published" value=0 />
			<textarea name="body" id="editor" placeholder="Content here ..."></textarea>
			<p class="write-btn-box">
			<button type="submit" class="btn-white" onclick="preview(); return false;" >
			<span class="icon-eye">Preview</span>
			</button>
			<button type="submit" class="btn-white" onclick="save_to_draft();" >
			<span class="icon-disk">Save as draft</span>
			</button>
			<button type="submit" class="btn-blue" onclick="publish_post();" >
			<span class="icon-blog">Publish</span>
			</button>
			</p>
		</form>
	</div>
</div>
<script type="text/javascript">
  // init editor
  var editor = new Editor();
  editor.render();

  var form = document.workspace;

  var save_to_draft = function() {
    editor.codemirror.save();
    form.target = '_self';
    form.action= '';
    form.published.value = 0;
    form.submit()
  };

  var publish_post = function() {
    editor.codemirror.save();
    form.target = '_self';
    form.action= '';
    form.published.value = 1;
    form.submit()
  };

  var preview = function() {
    editor.codemirror.save();
    form.target = '_blank';
    form.action = '';
    form.submit();
  };
</script>
{% endblock %}